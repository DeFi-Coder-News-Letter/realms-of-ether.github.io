webpackJsonp([1],{G44s:function(t,e,s){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}s.d(e,"a",function(){return c});var o=s("KM04"),a=(s.n(o),s("N3gZ")),u=s.n(a),r=s("sw5u"),c=(s.n(r),function(t){function e(){return i(this,t.apply(this,arguments))}return n(e,t),e.prototype.render=function(){return Object(o.h)(r.Link,{href:this.props.to,className:u.a.button},this.props.children)},e}(o.Component))},HaUu:function(t,e,s){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),s.d(e,"default",function(){return N});var o=s("KM04"),a=(s.n(o),s("0+Hh")),u=s("G44s"),r=s("rAoZ"),c=s("R+ko"),h=s.n(c),b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},l=s("+ENZ").default,d=Object(o.h)("br",null),f=Object(o.h)("br",null),p=Object(o.h)("br",null),m=Object(o.h)("br",null),g=Object(o.h)("br",null),A=Object(o.h)("br",null),O=Object(o.h)("br",null),v=Object(o.h)("br",null),j=Object(o.h)("br",null),y=Object(o.h)("h3",null,"All Auctions"),w=Object(o.h)("h3",null,"My Auctions"),N=function(t){function e(){var e=i(this,t.call(this));return e.state={userAuctions:{},auctions:{},page:0,userPage:0,user:""},e}return n(e,t),e.prototype.componentWillMount=function(){this.getAuctions(),this.getUserAuctions()},e.prototype.getAuctions=function(){var t=this;l.getAuctionsLength(function(e,s){var i=s.toNumber()-10*(t.state.page+1);i<0&&(i=0);for(var n=s.toNumber()-10*t.state.page;n>i;n--)l.auctions(n-1,function(e,s){l.getFortress(s,function(e,i){var n=b({},t.state,{auctions:b({},t.state.auctions)});n.auctions[s]=b({},n.auctions[s],{name:web3.toAscii(i[0]).replace(/\u0000/g,""),x:i[2].toNumber(),y:i[3].toNumber(),wins:i[4].toNumber()}),t.setState(n)}),l.highestBid(s,function(e,i){var n=b({},t.state,{auctions:b({},t.state.auctions),bids:b({},t.state.bids)});n.auctions[s]=b({},n.auctions[s],{highestBid:web3.fromWei(i.toNumber()/99*100)}),n.bids[s]=parseFloat(web3.fromWei(i.toNumber()/99*100))+.1,t.setState(n)}),l.auctionEnd(s,function(e,i){var n=b({},t.state,{auctions:b({},t.state.auctions)});n.auctions[s]=b({},n.auctions[s],{auctionEnd:i.toNumber()}),t.setState(n)})})})},e.prototype.getUserAuctions=function(){var t=this;web3.eth.getAccounts(function(e,s){t.setState(b({},t.state,{user:s[0]})),l.getUserAuctionsLength(s[0],function(e,i){var n=i.toNumber()-5*(t.state.userPage+1);n<0&&(n=0);for(var o=i.toNumber()-5*t.state.userPage;o>n;o--)l.userAuctions(s[0],o-1,function(e,i){l.getFortress(i,function(e,s){var n=b({},t.state,{userAuctions:b({},t.state.userAuctions)});n.userAuctions[i]=b({},n.userAuctions[i],{name:web3.toAscii(s[0]).replace(/\u0000/g,""),x:s[2].toNumber(),y:s[3].toNumber(),wins:s[4].toNumber()}),t.setState(n)}),l.highestBid(i,function(e,s){var n=b({},t.state,{userAuctions:b({},t.state.userAuctions)});n.userAuctions[i]=b({},n.userAuctions[i],{highestBid:web3.fromWei(s.toNumber()/99*100)}),t.setState(n)}),l.highestBidder(i,function(e,s){var n=b({},t.state,{userAuctions:b({},t.state.userAuctions)});n.userAuctions[i]=b({},n.userAuctions[i],{highestBidder:s}),t.setState(n)}),l.auctionEnd(i,function(e,s){var n=b({},t.state,{userAuctions:b({},t.state.userAuctions)});n.userAuctions[i]=b({},n.userAuctions[i],{auctionEnd:s.toNumber()}),t.setState(n)}),l.getAuctionAmount(i,s[0],function(e,s){var n=b({},t.state,{userAuctions:b({},t.state.userAuctions)});n.userAuctions[i]=b({},n.userAuctions[i],{amount:web3.fromWei(s.toNumber())}),t.setState(n)})})})})},e.prototype.updateInputValue=function(t,e){var s=b({},this.state,{bids:b({},this.state.bids)});s.bids[t]=e.target.value,this.setState(s)},e.prototype.bid=function(t){l.bidAuction(t,{value:web3.toWei(this.state.bids[t])},function(){})},e.prototype.claim=function(t){l.endAuction(t,function(){})},e.prototype.withdraw=function(t){l.withdraw(t,function(){})},e.prototype.render=function(){var t=[];for(var e in this.state.auctions){var s="";this.state.bids&&this.state.bids[e]&&(s=Object(o.h)("input",{value:this.state.bids[e],onChange:this.updateInputValue.bind(this,e),className:h.a.input}));var i=new Date(1e3*this.state.auctions[e].auctionEnd),n="";Date.now()<=1e3*this.state.auctions[e].auctionEnd&&(n=Object(o.h)("div",{className:h.a.resources},s,Object(o.h)(r.a,{onClick:this.bid.bind(this,e)},"Bid"),"If already bid, it increases your bid"));t.push(Object(o.h)("div",{className:h.a.fortress},Object(o.h)("div",{className:h.a.window},Object(o.h)("img",{src:"/assets/castle.png",width:"60",className:h.a.castle})),n,Object(o.h)("div",{className:h.a.content},this.state.auctions[e].name," (",this.state.auctions[e].x,"/",this.state.auctions[e].y,")",d,"Highest bid: ",this.state.auctions[e].highestBid,f,"End:",i.toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),p,m,Object(o.h)(u.a,{to:"/fortress/"+e},"Details")),Object(o.h)("div",{className:h.a.end})))}var c=[];for(var e in this.state.userAuctions){var s="";this.state.bids&&this.state.bids[e]&&(s=Object(o.h)("input",{value:this.state.bids[e],onChange:this.updateInputValue.bind(this,e),className:h.a.input}));var b=new Date(1e3*this.state.userAuctions[e].auctionEnd),n="";n=Date.now()<=1e3*this.state.userAuctions[e].auctionEnd?Object(o.h)("div",{className:h.a.resources},s,Object(o.h)(r.a,{onClick:this.bid.bind(this,e)},"Bid"),"If already bid, it increases your bid"):this.state.userAuctions[e].highestBidder===this.state.user?Object(o.h)("div",{className:h.a.resources},Object(o.h)(r.a,{onClick:this.claim.bind(this,e)},"Claim"),"If this fails, increase gas limit"):Object(o.h)("div",{className:h.a.resources},"Amount: ",this.state.userAuctions[e].amount,Object(o.h)(r.a,{onClick:this.withdraw.bind(this,e)},"Withdraw"),"If this fails, increase gas limit");c.push(Object(o.h)("div",{className:h.a.fortress},Object(o.h)("div",{className:h.a.window},Object(o.h)("img",{src:"/assets/castle.png",width:"60",className:h.a.castle})),n,Object(o.h)("div",{className:h.a.content},this.state.userAuctions[e].name," (",this.state.userAuctions[e].x,"/",this.state.userAuctions[e].y,")",g,"Highest bid: ",this.state.userAuctions[e].highestBid,A,"End:",b.toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),O,v,Object(o.h)(u.a,{to:"/fortress/"+e},"Details")),Object(o.h)("div",{className:h.a.end})))}return Object(o.h)(a.a,null,"Caution! If you win your own auction, you can reclaim the fortress, but not the ether!",j,"There is also a 1% fee!",y,t,w,c)},e}(o.Component)},N3gZ:function(t){t.exports={button:"button__2iZ3o"}},"R+ko":function(t){t.exports={fortress:"fortress__2f5gj",window:"window__2C3Pi",castle:"castle__2lR2_",resources:"resources__37fZD",end:"end__3lKKU"}}});
//# sourceMappingURL=route-auction.chunk.ce43c.js.map