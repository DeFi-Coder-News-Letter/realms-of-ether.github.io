webpackJsonp([3],{WNga:function(t,e,s){"use strict";function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),s.d(e,"default",function(){return k});var r=s("KM04"),i=(s.n(r),s("0+Hh")),a=s("rAoZ"),u=s("e0/M"),c=s.n(u),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o])}return t},b=s("+ENZ").default,h=Object(r.h)("br",null),d=Object(r.h)("img",{src:"/assets/gold.png",alt:"Gold",height:"24"}),g=Object(r.h)("br",null),f=Object(r.h)("img",{src:"/assets/stone.png",alt:"Stone",height:"24"}),p=Object(r.h)("br",null),m=Object(r.h)("img",{src:"/assets/wood.png",alt:"Wood",height:"24"}),O=Object(r.h)("br",null),j=Object(r.h)("br",null),v=Object(r.h)("br",null),N=Object(r.h)("br",null),w=Object(r.h)("img",{src:"/assets/gold.png",alt:"Gold",height:"24"}),y=Object(r.h)("img",{src:"/assets/stone.png",alt:"Stone",height:"24"}),_=Object(r.h)("img",{src:"/assets/wood.png",alt:"Wood",height:"24"}),S=Object(r.h)("br",null),A=Object(r.h)("br",null),T=Object(r.h)("img",{src:"/assets/gold.png",alt:"Gold",height:"24"}),x=Object(r.h)("br",null),R=Object(r.h)("img",{src:"/assets/stone.png",alt:"Stone",height:"24"}),B=Object(r.h)("br",null),C=Object(r.h)("img",{src:"/assets/wood.png",alt:"Wood",height:"24"}),H=Object(r.h)("br",null),L=Object(r.h)("br",null),M=Object(r.h)("h3",null,"Buildings"),k=function(t){function e(){var e=o(this,t.call(this));return e.state={buildings:{},troups:{},fortress:{name:"Loading...",hash:""},account:""},e}return n(e,t),e.prototype.componentWillMount=function(){var t=this;web3.eth.getAccounts(function(e,s){t.setState(l({},t.state,{account:s[0]}))}),b.getBuildingIndexLength(function(e,s){for(var o=0;o<s.toNumber();o++)b.getBuildingHash(o,function(e,s){b.getBuilding(s,function(e,o){var n=l({},t.state,{buildings:l({},t.state.buildings)});n.buildings[s]=l({},t.state.buildings[s],{name:web3.toAscii(o[0]).replace(/\u0000/g,""),action:o[1].toNumber(),actionRate:o[2].toNumber(),actionValue:o[3],actionTimeout:o[4].toNumber()}),t.setState(n)})})}),b.getTroupIndexLength(function(e,s){for(var o=0;o<s.toNumber();o++)b.getTroupHash(o,function(e,s){b.getTroup(s,function(e,o){var n=l({},t.state,{troups:l({},t.state.troups)});n.troups[s]=l({},t.state.troups[s],{name:web3.toAscii(o[0]).replace(/\u0000/g,""),life:o[1].toNumber(),strength:o[1].toNumber(),intelligence:o[1].toNumber(),dexterity:o[1].toNumber()}),t.setState(n)}),b.getTroupCosts(s,function(e,o){var n=l({},t.state,{troups:l({},t.state.troups)});n.troups[s]=l({},t.state.troups[s],{gold:o[0].toNumber(),stone:o[1].toNumber(),wood:o[2].toNumber()}),t.setState(n)})})})},e.prototype.startAuction=function(t){b.startAuction(t,function(){})},e.prototype.build=function(t,e){b.build(t,e,function(){})},e.prototype.buildingAction=function(t,e){b.buildingAction(t,e,function(){})},e.prototype.render=function(t){var e=this,s=t.fortressHash;if(this.state.fortress.hash!==s)return b.getFortress(s,function(t,s){e.setState(l({},e.state,{fortress:l({},e.state.fortress,{name:web3.toAscii(s[0]),owner:s[1],x:s[2].toNumber(),y:s[3].toNumber(),wins:s[4].toNumber()})}))}),b.getResources(s,function(t,s){e.setState(l({},e.state,{fortress:l({},e.state.fortress,{gold:s[0].toNumber(),stone:s[1].toNumber(),wood:s[2].toNumber()})}))}),b.getBuildingIndexLength(function(t,o){for(var n=0;n<o.toNumber();n++)b.getBuildingHash(n,function(t,o){b.getFortressBuilding(s,o,function(t,s){var n=l({},e.state,{buildings:l({},e.state.buildings)});n.buildings[o]=l({},e.state.buildings[o],{level:s[0].toNumber(),timeout:s[1].toNumber()}),e.setState(n),b.getBuildingCosts(o,function(t,n){var r=l({},e.state,{buildings:l({},e.state.buildings)});r.buildings[o]=l({},e.state.buildings[o],{gold:n[0].toNumber()*(s[0].toNumber()+1),stone:n[1].toNumber()*(s[0].toNumber()+1),wood:n[2].toNumber()*(s[0].toNumber()+1)}),e.setState(r)})})})}),b.getTroupIndexLength(function(t,o){for(var n=0;n<o.toNumber();n++)b.getTroupHash(n,function(t,o){b.getFortressTroups(s,o,function(t,s){var n=l({},e.state,{troups:l({},e.state.troups)});n.troups[o]=l({},e.state.troups[o],{amount:s.toNumber()}),e.setState(n)})})}),void this.setState(l({},this.state,{fortress:l({},this.state.fortress,{hash:s})}));var o=[];for(var n in this.state.buildings)if("0x013fe665d081d447d18c02806c23234ff4e64e732fa7a5814abc87a0dac86737"!==n){var u=this.state.buildings[n],k=u.name,I=u.action,W=u.actionRate,E=u.actionValue,F=u.actionTimeout,P=u.level,G=u.timeout,K=u.gold,V=u.stone,Z=u.wood,z=new Date,D=Object(r.h)(a.a,{onClick:this.buildingAction.bind(this,s,n)},1===I?"Mine":"Recrute");(z<1e3*G||this.state.account!==this.state.fortress.owner)&&(D="");var J=Object(r.h)(a.a,{onClick:this.build.bind(this,s,n)},"Build");this.state.account!==this.state.fortress.owner&&(J="");var Y="";if(this.state.troups[E]&&P>=0){var q=this.state.troups[E].gold*(P+1)*W,Q=this.state.troups[E].stone*(P+1)*W,U=this.state.troups[E].wood*(P+1)*W,X=(P+1)*W;Y=Object(r.h)("div",{className:c.a.troup},Object(r.h)("div",{className:c.a.window},Object(r.h)("img",{src:"/assets/troups/"+this.state.troups[E].name+".png",width:"60",className:c.a.castle})),Object(r.h)("div",{className:c.a.troupResources},Object(r.h)("div",null,"Costs:",h,q,d,g,Q,f,p,U,m)),Object(r.h)("div",{className:c.a.content},this.state.troups[E].name,O,j,"Recruting ",X," Troups",v,"Available: ",this.state.troups[E].amount),Object(r.h)("div",{className:c.a.end}))}o.push(Object(r.h)("div",null,Object(r.h)("div",{className:c.a.fortress},Object(r.h)("div",{className:c.a.window},Object(r.h)("img",{src:"/assets/buildings/"+k+".png",width:"60",className:c.a.castle})),Object(r.h)("div",{className:c.a.resources},Object(r.h)("div",null,J,D)),Object(r.h)("div",{className:c.a.content},k," (Level: ",P,")",N,"Costs: ",K,w,V,y,Z,_,S,1===I?"Mining":"Recruting",": Every ",F," Hours",A),Object(r.h)("div",{className:c.a.end})),Y))}var $=Object(r.h)(a.a,{onClick:this.startAuction.bind(this,s)},"Start auction");return this.state.account!==this.state.fortress.owner&&($=""),Object(r.h)(i.a,null,Object(r.h)("h1",null,this.state.fortress.name),Object(r.h)("div",{className:c.a.fortress},Object(r.h)("div",{className:c.a.window},Object(r.h)("img",{src:"/assets/castle.png",width:"60",className:c.a.castle})),Object(r.h)("div",{className:c.a.resources},Object(r.h)("div",null,this.state.fortress.gold,T,x,this.state.fortress.stone,R,B,this.state.fortress.wood,C)),Object(r.h)("div",{className:c.a.content},"(",this.state.fortress.x,"/",this.state.fortress.y,")",H,L,$),Object(r.h)("div",{className:c.a.end})),M,o)},e}(r.Component)},"e0/M":function(t){t.exports={fortress:"fortress__3yYSI",window:"window__1sOKp",castle:"castle__1dCia",resources:"resources__3T4Nw",troupResources:"troupResources__1z2Nb",end:"end__1bFL8",troup:"troup__jvt9k"}}});
//# sourceMappingURL=route-fortress.chunk.036a5.js.map